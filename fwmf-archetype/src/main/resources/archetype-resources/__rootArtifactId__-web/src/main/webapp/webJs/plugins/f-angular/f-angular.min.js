/*! f-angular.min.js version:0.0.1 2017-05-06 */
$("body").height()<document.documentElement.clientHeight&&($("body").css("height","100%"),$("html").css("height","100%"));var fangular=angular.module("fangular",[]);try{for(var dragLen=$(".splitbar").length,i=0;dragLen>i;i++)$("body .splitbar:eq("+i+")").mouseover(function(a){$(this).css("cursor","e-resize")}),$("body .splitbar:eq("+i+")").mousedown(function(a){$(this).css("cursor","e-resize");var b=$(this),c=$(this).prev().outerWidth(),d=$(this).next().outerWidth();$(this).prev().hasClass("col")&&($(this).prev().addClass("col-fixed"),$(this).prev().removeClass("col"),$(this).prev().css("width",c+"px")),$(this).next().hasClass("col")&&($(this).next().addClass("col-fixed"),$(this).next().removeClass("col"),$(this).next().css("width",d+"px")),$("body").mousemove(function(a){var c=a.pageX,d=0,e=0;if(1==b.prevAll().length){var f=b.next().outerWidth()+b.prev().outerWidth();c>f&&(c=f),b.prev().animate({width:c},1),console.log("left:"+c);var g=f-c;b.next().animate({width:g},1),console.log("right:"+g)}else{var h=b.next().outerWidth()+b.prev().outerWidth(),i=b;for(i=i.prev();0!=i.prev().length;)d=i.prev().outerWidth(),e+=d,i=i.prev();var j=c-e,k=h+e-c;0>j?j=0:j>h&&(j=h),0>k?k=0:k>h&&(k=h),b.prev().animate({width:j},1),b.next().animate({width:k},1)}})}),$("body").mouseup(function(a){$(this).unbind("mousemove"),$(this).css("cursor","default")})}catch(e){console.log("未配置jQuery，分隔条无法拖动！")}fangular.constant("PAGING",{pageSize:20,pageSizeList:[5,10,20,50,100]}),fangular.factory("fGridHelper",["$http","PAGING",function(a,b){var c=function(b){var c=b.config.url;if(angular.isUndefined(c)||""==c||"null"==c)throw new Error("请求的网络地址不可以为空！");angular.isUndefined(b.searchedParam)&&(b.searchedParam={}),b.searchedParam.pageNo=b.paging.pageNo,b.searchedParam.pageSize=b.paging.pageSize,a.get(c,{params:b.searchedParam}).success(function(a){var c=b.paging;c.results=a.results,c.totalRecord=a.totalRecord,c.pageNo=a.pageNo,0==parseInt(c.totalRecord)?c.totalPage=1:parseInt(c.totalRecord)%parseInt(c.pageSize)==0?c.totalPage=parseInt(parseInt(c.totalRecord)/parseInt(c.pageSize)):c.totalPage=parseInt(parseInt(c.totalRecord)/parseInt(c.pageSize))+1,c.pageList=[];for(var d=1;d<=c.totalPage;d++)c.pageList.push(d);c.btnsDisabled.goToFirstPage=!0,c.btnsDisabled.goToPrevPage=!0,c.btnsDisabled.goToNextPage=!0,c.btnsDisabled.goToEndPage=!0,c.pageNo>1&&(c.btnsDisabled.goToFirstPage=!1,c.btnsDisabled.goToPrevPage=!1),c.pageNo<c.totalPage&&(c.btnsDisabled.goToNextPage=!1,c.btnsDisabled.goToEndPage=!1),c.selectAllItems=!1}).error(function(a){console.log("[Error]$http错误："+a)})},d=function(a,b,c){var d="";return d=d+'<div ng-if="'+a+'.config.showPaging" class="grid-paging">',d=d+' 共&nbsp;<span ng-bind="'+a+'.paging.totalRecord"></span>&nbsp;条记录&nbsp;',d+=" 第",d=d+'   <select ng-model="'+a+'.paging.pageNo" ',d+='           ng-change="changePageNo()" ',d=d+'           ng-options="item as item for item in '+a+'.paging.pageList">',d+="   </select>",d=d+' 页/共&nbsp;<span ng-bind="'+a+'.paging.totalPage"></span>&nbsp;页&nbsp;',d+=" 每页&nbsp;",d=d+'   <select ng-model="'+a+'.paging.pageSize" ',d+='           ng-change="changePageSize()" ',d=d+'           ng-options="item as item for item in '+a+'.paging.pageSizeList">',d+="   </select>",d+=" &nbsp;条",d+=' <div class="grid-paging-btns">',d=d+"  <button ng-class=\"{'btn':true, 'btn-xs':true, 'btn-page-disabled':"+a+".paging.btnsDisabled.goToFirstPage, 'btn-page-enabled':!"+a+'.paging.btnsDisabled.goToFirstPage}" ng-click="goToFirstPage()" ng-disabled="'+a+'.paging.btnsDisabled.goToFirstPage">首页</button>',d=d+"  <button ng-class=\"{'btn':true, 'btn-xs':true, 'btn-page-disabled':"+a+".paging.btnsDisabled.goToPrevPage, 'btn-page-enabled':!"+a+'.paging.btnsDisabled.goToPrevPage}" ng-click="goToPrevPage()" ng-disabled="'+a+'.paging.btnsDisabled.goToPrevPage">上一页</button>',d=d+"  <button ng-class=\"{'btn':true, 'btn-xs':true, 'btn-page-disabled':"+a+".paging.btnsDisabled.goToNextPage, 'btn-page-enabled':!"+a+'.paging.btnsDisabled.goToNextPage}" ng-click="goToNextPage()" ng-disabled="'+a+'.paging.btnsDisabled.goToNextPage">下一页</button>',d=d+"  <button ng-class=\"{'btn':true, 'btn-xs':true, 'btn-page-disabled':"+a+".paging.btnsDisabled.goToEndPage, 'btn-page-enabled':!"+a+'.paging.btnsDisabled.goToEndPage}" ng-click="goToEndPage()" ng-disabled="'+a+'.paging.btnsDisabled.goToEndPage">尾页</button>',d+=" </div>",d+="</div>"},e={};return e.initParam=function(a){a.searched=!1,a.searchedParam={},angular.isUndefined(a.config.showLineNo)&&(a.config.showLineNo=!0),angular.isUndefined(a.config.showChecked)&&(a.config.showChecked=!1),angular.isUndefined(a.config.singleChecked)&&(a.config.showChecked===!0?a.config.singleChecked=!1:a.config.singleChecked=!0),angular.isUndefined(a.config.showPaging)&&(a.config.showPaging=!0),angular.isUndefined(a.config.initSearch)&&(a.config.initSearch=!0),angular.isUndefined(a.paging)&&(a.paging={}),angular.isUndefined(a.paging.pageSize)&&(a.paging.pageSize=b.pageSize),a.paging.pageNo=1,a.paging.totalPage=1,a.paging.totalRecord=0,a.paging.results=[],angular.isArray(a.data)&&(a.paging.results=a.data),a.paging.pageList=[1],a.paging.pageSizeList=b.pageSizeList,a.paging.btnsDisabled={goToFirstPage:!0,goToPrevPage:!0,goToNextPage:!0,goToEndPage:!0},a.paging.selectAllItems=!1},e.createTableTplHtml=function(a,b,c){var e="";return e+='<div class="grid">',e+='  <div class="grid-body">',e+='    <table class="table table-hover table-striped table-condensed">',e+="      <thead>",e+="        <tr>",e=e+'          <th ng-if="'+a+'.config.showLineNo" class="row-idx">&nbsp;</th>',e=e+'          <th ng-if="'+a+'.config.showChecked" class="row-cb"><input type="checkbox" ng-if="!'+a+'.config.singleChecked" ng-model="'+a+'.paging.selectAllItems" ng-click="selectAllItemsHandler()"></th>',e=e+'          <th ng-repeat="col in '+a+'.columns">{{col.title}}</th>',e+="        </tr>",e+="      </thead>",e+="      <tbody>",e=e+'        <tr ng-repeat="row in '+a+'.paging.results" ng-click="rowClickHandler(row)" ng-class="{\'selected\':row.checked}">',e=e+'          <td ng-if="'+a+'.config.showLineNo" ng-bind="$index+1" class="row-idx">&nbsp;</td>',e=e+'          <td ng-if="'+a+'.config.showChecked" class="row-cb">',e+='            <input type="checkbox" ng-model="row.checked" ng-click="checkboxClickHandler(row,$event)">',e+="          </td>",e=e+'          <td ng-repeat="col in '+a+'.columns" style="{{col.style}}" class="{{col.class}}" ng-bind-html="row[col.bind] | injectFilter:col.filter | trustHtmlFilter"></td>',e+="        </tr>",e+="      </tbody>",e+="    </table>",e+="  </div>",e+=d(a,b,c),e+="</div>"},e.reloadData=function(a){a.searched&&c(a)},e.searchData=function(a,b){a.paging.pageNo=1,a.searchedParam=b,c(a),a.searched=!0},e.getSelectionItems=function(a){var b=[];return angular.forEach(a.paging.results,function(a){a.checked===!0&&b.push(a)}),b},e.selectAllItemsHandler=function(a){a.paging.selectAllItems?this.selectAllItems(a):this.unselectAllItems(a)},e.selectAllItems=function(a){a.paging.selectAllItems=!0;for(var b=0;b<a.paging.results.length;b++)a.paging.results[b].checked=!0},e.unselectAllItems=function(a){a.paging.selectAllItems=!1;for(var b=0;b<a.paging.results.length;b++)a.paging.results[b].checked=!1},e.selectItemHandler=function(a,b){if(a.config.singleChecked===!0){var c=b.checked;this.unselectAllItems(a),b.checked=c}else{var d=!1;angular.forEach(a.paging.results,function(a){a.checked!==!0&&(d=!0)}),a.paging.selectAllItems=!d}},e.goToFirstPage=function(a){a.searched&&a.paging.pageNo>1&&(a.paging.pageNo=1,this.reloadData(a))},e.goToPrevPage=function(a){a.searched&&a.paging.pageNo>1&&(a.paging.pageNo=a.paging.pageNo-1,this.reloadData(a))},e.goToNextPage=function(a){a.searched&&a.paging.pageNo<a.paging.totalPage&&(a.paging.pageNo=a.paging.pageNo+1,this.reloadData(a))},e.goToEndPage=function(a){a.searched&&a.paging.pageNo<a.paging.totalPage&&(a.paging.pageNo=a.paging.totalPage,this.reloadData(a))},e}]),fangular.directive("fGrid",["fGridHelper",function(a){var b=function(b){if(angular.isUndefined(b))throw new Error("配置参数grid不可以为空！");if(angular.isUndefined(b.config))throw new Error("配置参数grid.config不可以为空！");a.initParam(b)};return{restrict:"EA",replace:!0,scope:{_grid:"=grid"},template:function(b,c){return a.createTableTplHtml("_grid",b,c)},link:function(c,d,e){if(b(c._grid),c._grid.search=function(b){a.searchData(c._grid,b)},c._grid.reload=function(){a.reloadData(c._grid)},c._grid.getSelectionItems=function(){return a.getSelectionItems(c._grid)},c.selectAllItemsHandler=function(){a.selectAllItemsHandler(c._grid)},c.changePageSize=function(){a.reloadData(c._grid)},c.changePageNo=function(){a.reloadData(c._grid)},c.goToFirstPage=function(){a.goToFirstPage(c._grid)},c.goToPrevPage=function(){a.goToPrevPage(c._grid)},c.goToNextPage=function(){a.goToNextPage(c._grid)},c.goToEndPage=function(){a.goToEndPage(c._grid)},c.checkboxClickHandler=function(b,d){a.selectItemHandler(c._grid,b),d&&d.stopPropagation?d.stopPropagation():window.event.cancelBubble=!0},c.rowClickHandler=function(b){b.checked=!b.checked,a.selectItemHandler(c._grid,b)},c._grid.config.initSearch===!0){var f=c._grid.config&&c._grid.config.params||{};c._grid.search(f)}}}}]),fangular.filter("injectFilter",["$filter",function(a){return function(b,c){return"function"==typeof c?c(b):"string"==typeof c?a(c)(b):b}}]),fangular.filter("trustHtmlFilter",["$sce",function(a){return function(b){return null==b||void 0==b?b:(angular.isString(b)||(b+=""),a.trustAsHtml(b))}}]),fangular.directive("fToolbar",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{search:"=fSearch",reset:"=fReset"},template:function(a,b){var c=angular.isDefined(b.fSearch),d=angular.isDefined(b.fReset),e="";return e+='<div class="toolbar">',e+='<div class="toolbar-left" ng-transclude></div>',(c||d)&&(e+='<div class="toolbar-right">',c&&(e+='  <span><button class="btn btn-danger btn-search" type="button" ng-click="search()">查&nbsp;&nbsp;询</button></span>'),d&&(e+='  <span><button class="btn btn-danger btn-reset" type="button" ng-click="reset()">重&nbsp;&nbsp;置</button></span>'),e+="</div>"),e+="</div>"}}}),fangular.directive("fToolbarButton",function(){return{require:"^?fToolbar",restrict:"EA",replace:!0,scope:{handler:"=fHandler",text:"=fText",css:"=fCss"},template:'<span><button class="btn btn-info btn-view {{css}}" type="button" ng-click="clickHandler()">{{text}}</button></span>',link:function(a,b,c,d){a.clickHandler=function(){a.$parent[a.handler]()}}}}),fangular.directive("fToolbarNormalButton",function(){return{require:"^?fToolbar",restrict:"EA",replace:!0,scope:{id:"=fId",text:"=fText",css:"=fCss"},template:'<span><button class="btn btn-info btn-view {{css}}" type="button" id="{{id}}">{{text}}</button></span>'}});